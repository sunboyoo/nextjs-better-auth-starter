# ==============================================
# 1. App & Core Configuration
# ==============================================
BETTER_AUTH_SECRET=your-better-secret-key-change-me
BETTER_AUTH_URL=http://localhost:3000
NEXT_PUBLIC_APP_URL=http://localhost:3000
BETTER_AUTH_TRUSTED_ORIGINS=http://localhost:3000
NEXT_PUBLIC_BETTER_AUTH_ELECTRON_SCHEME=com.nextjs.better-auth.starter
# OAuth dynamic client registration hardening (default disabled)
BETTER_AUTH_OAUTH_ALLOW_DYNAMIC_CLIENT_REGISTRATION=false
BETTER_AUTH_OAUTH_ALLOW_UNAUTHENTICATED_CLIENT_REGISTRATION=false
# Optional: development|test|production (defaults to development when unset)
NODE_ENV=development
# Optional: rate limit controls
BETTER_AUTH_RATE_LIMIT_ENABLED=
BETTER_AUTH_RATE_LIMIT_WINDOW=
BETTER_AUTH_RATE_LIMIT_MAX=
BETTER_AUTH_RATE_LIMIT_STORAGE=
# Optional:
# - "memory": in-process storage, not suitable for distributed production
# - "upstash-redis": shared secondary storage over Upstash REST API
BETTER_AUTH_SECONDARY_STORAGE=
# Required when BETTER_AUTH_SECONDARY_STORAGE=upstash-redis
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# ==============================================
# 2. Database Configuration
# ==============================================
DATABASE_URL=postgresql://your-database-user:your-database-password@your-database-host/your-database-name?sslmode=require

# ==============================================
# 3. Email Configuration (Resend)
# ==============================================
RESEND_API_KEY=your-resend-api-key
RESEND_EMAIL_FROM="Your Name <no-reply@your-verified-domain.com>"

# ==============================================
# 4. OAuth Providers
# ==============================================
# Google
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
NEXT_PUBLIC_GOOGLE_CLIENT_ID=your-google-client-id

# GitHub
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# Detailed Providers (leaving empty for example)
FACEBOOK_CLIENT_ID=
FACEBOOK_CLIENT_SECRET=
DISCORD_CLIENT_ID=
DISCORD_CLIENT_SECRET=
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=
MICROSOFT_TENANT_ID=common
MICROSOFT_AUTHORITY=https://login.microsoftonline.com
TWITCH_CLIENT_ID=
TWITCH_CLIENT_SECRET=
TWITTER_CLIENT_ID=
TWITTER_CLIENT_SECRET=
PAYPAL_CLIENT_ID=
PAYPAL_CLIENT_SECRET=
VERCEL_CLIENT_ID=
VERCEL_CLIENT_SECRET=

# ==============================================
# 5. Captcha (Turnstile)
# ==============================================
BETTER_AUTH_CAPTCHA_ENABLED=false
BETTER_AUTH_CAPTCHA_PROVIDER=cloudflare-turnstile
BETTER_AUTH_CAPTCHA_SECRET_KEY=
# Optional: comma-separated custom endpoints in addition to built-in protected endpoints
BETTER_AUTH_CAPTCHA_EXTRA_ENDPOINTS=
BETTER_AUTH_CAPTCHA_MIN_SCORE=0.5
BETTER_AUTH_CAPTCHA_SITE_KEY=
NEXT_PUBLIC_BETTER_AUTH_CAPTCHA_ENABLED=false
NEXT_PUBLIC_BETTER_AUTH_CAPTCHA_PROVIDER=cloudflare-turnstile
NEXT_PUBLIC_BETTER_AUTH_CAPTCHA_SITE_KEY=

# ==============================================
# 6. Magic Link
# ==============================================
BETTER_AUTH_MAGIC_LINK_EXPIRES_IN=300
BETTER_AUTH_MAGIC_LINK_DISABLE_SIGN_UP=false

# ==============================================
# 7. Email OTP
# ==============================================
BETTER_AUTH_EMAIL_OTP_EXPIRES_IN=300
BETTER_AUTH_EMAIL_OTP_LENGTH=6
BETTER_AUTH_EMAIL_OTP_ALLOWED_ATTEMPTS=3
BETTER_AUTH_EMAIL_OTP_DISABLE_SIGN_UP=false
BETTER_AUTH_EMAIL_OTP_SEND_VERIFICATION_ON_SIGN_UP=false

# ==============================================
# 8. Phone OTP
# ==============================================
BETTER_AUTH_PHONE_OTP_EXPIRES_IN=300
BETTER_AUTH_PHONE_OTP_LENGTH=6
BETTER_AUTH_PHONE_OTP_ALLOWED_ATTEMPTS=3
BETTER_AUTH_PHONE_REQUIRE_VERIFICATION=true
BETTER_AUTH_PHONE_SIGN_UP_ON_VERIFICATION=true
# Temporary emails for phone-first sign-ups use this domain.
BETTER_AUTH_PHONE_TEMP_EMAIL_DOMAIN=phone.invalid
# Public mirror for client-side UX gating against placeholder domains.
NEXT_PUBLIC_BETTER_AUTH_PHONE_TEMP_EMAIL_DOMAIN=phone.invalid
# Optional webhook to deliver SMS (JSON payload with phoneNumber/code/type).
BETTER_AUTH_PHONE_OTP_WEBHOOK_URL=http://localhost:3000/api/auth/webhook/phone-otp
BETTER_AUTH_PHONE_OTP_WEBHOOK_AUTH_TOKEN=your-strong-random-webhook-token
# OTP webhook service mode:
# - twilio-live: use incoming OTP code from Better Auth
# - twilio-test-fixed-otp: both webhook send path and server verify path use BETTER_AUTH_PHONE_OTP_FIXED_TEST_CODE (for deterministic tests)
BETTER_AUTH_PHONE_OTP_SERVICE_MODE=twilio-live
BETTER_AUTH_PHONE_OTP_FIXED_TEST_CODE=000000
# OTP anti-abuse throttles (per IP + per phone number).
BETTER_AUTH_PHONE_OTP_THROTTLE_ENABLED=true
BETTER_AUTH_PHONE_OTP_THROTTLE_WINDOW_SECONDS=600
BETTER_AUTH_PHONE_OTP_SEND_MAX_PER_IP=20
BETTER_AUTH_PHONE_OTP_SEND_MAX_PER_PHONE=6
BETTER_AUTH_PHONE_OTP_VERIFY_MAX_PER_IP=40
BETTER_AUTH_PHONE_OTP_VERIFY_MAX_PER_PHONE=12
BETTER_AUTH_PHONE_OTP_RESET_REQUEST_MAX_PER_IP=12
BETTER_AUTH_PHONE_OTP_RESET_REQUEST_MAX_PER_PHONE=6
BETTER_AUTH_PHONE_OTP_RESET_VERIFY_MAX_PER_IP=30
BETTER_AUTH_PHONE_OTP_RESET_VERIFY_MAX_PER_PHONE=10

# Twilio credentials (used inside your SMS webhook handler)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ==============================================
# 9. Google One Tap
# ==============================================
BETTER_AUTH_ONE_TAP_DISABLE_SIGN_UP=false
BETTER_AUTH_ONE_TAP_CLIENT_ID=
NEXT_PUBLIC_BETTER_AUTH_ENABLE_ONE_TAP=true
NEXT_PUBLIC_BETTER_AUTH_ONE_TAP_AUTO_SELECT=false
# Note: cancelOnTapOutside is incompatible with FedCM. Leave empty when FedCM is enabled.
NEXT_PUBLIC_BETTER_AUTH_ONE_TAP_CANCEL_ON_TAP_OUTSIDE=
NEXT_PUBLIC_BETTER_AUTH_ONE_TAP_CONTEXT=signin
NEXT_PUBLIC_BETTER_AUTH_ONE_TAP_BASE_DELAY=1000
NEXT_PUBLIC_BETTER_AUTH_ONE_TAP_MAX_ATTEMPTS=5
# FedCM provides a better UX in production but does NOT work on localhost.
# Set to true only for production with HTTPS.
NEXT_PUBLIC_BETTER_AUTH_ONE_TAP_FEDCM=false

# ==============================================
# 10. Payments (Stripe)
# ==============================================
# Feature Flags
BETTER_AUTH_ENABLE_STRIPE=true
NEXT_PUBLIC_BETTER_AUTH_ENABLE_STRIPE=true

# Configuration
STRIPE_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PLUS_PRICE_ID=
STRIPE_PLUS_ANNUAL_PRICE_ID=
STRIPE_PRO_PRICE_ID=
STRIPE_PRO_ANNUAL_PRICE_ID=

# ==============================================
# 11. SSO & Enterprise (SCIM)
# ==============================================
# Feature Flags
BETTER_AUTH_ENABLE_SSO=true
BETTER_AUTH_ENABLE_SCIM=true

# SSO Configuration
# Note: the current auth config enables SSO via plugin flag and defaults.
# These values are kept for future provider-specific SSO setup.
BETTER_AUTH_SSO_PROVIDER_ID=sso
BETTER_AUTH_SSO_ENTRY_POINT=
BETTER_AUTH_SSO_CERT=
